# UE蓝图中的时间轴Timeline

时间轴（Timeline）是Unreal Engine（UE）蓝图中用于控制时间驱动逻辑的核心工具。它通过可视化节点实现动画、事件触发和数值插值，极大简化了动态效果的开发流程。本文将深度解析时间轴的定义、节点参数含义、典型应用及优化技巧。

---

## 一、时间轴的定义与核心功能
时间轴是一种**基于时间的数据控制器**，可将时间与数值（浮点、向量、颜色等）或事件绑定，形成坐标系（横轴为时间，纵轴为数值/事件）。其核心功能包括：
- **数值插值**：通过关键帧实现平滑过渡（如颜色渐变、物体位移）。
- **事件触发**：在指定时间点执行特定操作（如播放音效、切换状态）。
- **播放控制**：支持正向/反向播放、暂停、跳转等操作。
- **多轨道支持**：同时管理浮点、向量、颜色、事件等多种数据类型。

典型应用场景：开门动画、光源变化、材质过渡、UI动态效果等。

---

## 二、时间轴节点参数详解
### 1. 基本参数配置
| 参数             | 含义                                                                 | 示例值/选项              |
|------------------|----------------------------------------------------------------------|--------------------------|
| **时间轴名称**   | 标识时间轴的唯一名称，用于蓝图内引用                                 | `DoorOpenTimeline`       |
| **起始时间**     | 时间轴的起点时间（单位：秒）                                         | 0.0                      |
| **持续时间**     | 时间轴总长度（单位：秒）                                             | 2.5                      |
| **循环模式**     | 播放完成后的行为：<br>- **无循环**：播放一次后停止<br>- **循环**：重复播放<br>- **往返循环**：正向→反向交替播放 | 无循环                   |
| **自动播放**     | 是否在蓝图初始化时自动启动时间轴                                     | ✔️启用                   |
| **网络同步**     | 启用后时间轴在多玩家游戏中同步状态                                   | ❌禁用                   |

### 2. 输入引脚（控制播放行为）
| 引脚名称           | 功能                                                                 |
|--------------------|----------------------------------------------------------------------|
| **Play**           | 从当前时间点开始正向播放                                             |
| **Play from Start**| 从时间轴起点开始正向播放（强制重置）                                 |
| **Stop**           | 立即停止播放                                                         |
| **Reverse**        | 从当前时间点开始反向播放                                             |
| **Reverse from End**| 从时间轴终点开始反向播放                                            |
| **Set New Time**   | 跳转到指定时间点（需配合`New Time`输入值）                           |

### 3. 输出引脚（反馈与数据）
| 引脚名称           | 功能                                                                 |
|--------------------|----------------------------------------------------------------------|
| **Update**         | 每帧输出当前时间点的插值结果（如浮点数值、向量等）                   |
| **Finished**       | 当时间轴自然播放完成时触发（手动停止不触发）                         |
| **Direction**      | 输出当前播放方向（正向`Forward`/反向`Backward`）                     |

### 4. 关键帧编辑器参数
- **插值类型**：
  - **线性插值（Constant）** ：匀速变化（适合机械运动）。
  - **曲线插值（非Constant）** ：平滑缓入缓出（适合自然动画）。
- **轨道类型**：
  - **Float Track**：浮点数值变化（如透明度调整）。
  - **Vector Track**：三维向量变化（如位置移动）。
  - **Event Track**：在指定时间触发自定义事件。

---

## 三、典型应用场景与实现步骤
### 1. 物体动画：自动门开合
1. **创建时间轴**：添加浮点轨道控制门的旋转角度（0°→90°）。
2. **绑定事件**：使用`OnActorClicked`事件触发`Play`/`Reverse`。
3. **连接组件**：将时间轴输出值传递给门的`SetRelativeRotation`节点。

### 2. UI动态效果：进度条填充
1. **浮点轨道**：定义0→1的进度值。
2. **材质参数**：通过`Lerp`节点混合空/满状态材质。
3. **循环模式**：设置为“往返循环”实现呼吸灯效果。

### 3. 特效控制：爆炸序列
1. **事件轨道**：在时间点0.2s触发粒子效果，0.5s播放音效。
2. **颜色轨道**：控制光源颜色从红→橙→黄渐变。

---

## 四、性能优化与常见错误
### 优化技巧
1. **减少关键帧密度**：优先使用曲线插值替代多关键帧。
2. **禁用非必要更新**：若无需每帧反馈，关闭`Update`引脚连接。
3. **合并轨道**：同一物体的多个属性（如位置+旋转）尽量共用时间轴。
4. **预计算插值**：复杂运动使用C++预计算后通过变量传递。

### 常见错误
| 错误现象                | 原因与解决方案                          |
|-------------------------|-----------------------------------------|
| 时间轴不触发`Finished`  | 检查是否手动停止播放（仅自然结束触发） |
| 插值结果跳跃            | 关键帧插值类型冲突（确保同一轨道类型一致） |
| 多玩家不同步            | 未启用`网络同步`或蓝图未设置为`复制`   |
| 性能卡顿                | 避免在`Update`中执行高消耗操作（如物理计算） |

---

